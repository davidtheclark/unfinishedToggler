function UnfinishedToggler(a){function b(){c.call(this),u.initial?e(u.initial):u.allOff||0!==f().length||y.first().trigger(u.event.split(" ")[0]),B.each(function(){var a=$(this).data("uft-group");a&&-1===z.indexOf(a)&&z.push(a)})}function c(){y.on(u.event,this.utils.simpleDebounce(function(){e(this)})),u.nextSelector&&$(u.nextSelector).click(s),u.prevSelector&&$(u.prevSelector).click(t)}function d(){y.off()}function e(a){i($(a))}function f(){return B.filter("."+w)}function g(a){return B.filter('[data-uft-group="'+a+'"]')}function h(a){return u.scattered?g(a.data("uft-group")):a.closest(u.groupSelector)}function i(a){j(h(a))}function j(a){var b=f();a.hasClass(w)?(u.allOff||!u.allOff&&A>1)&&m(a):(u.onlyOneOn&&m(b),k(a))}function k(a){o(a,"on",u.onDelay,u.onCallback),A++}function l(){if(u.onlyOneOn)throw new Error("UnfinishedToggler will not turnAllOn with the setting {onlyOneOn: true}.");k(B)}function m(a){o(a,"off",u.offDelay,u.offCallback),A--}function n(){if(!u.allOff)throw new Error("UnfinishedToggler will not turnAllOff with the setting {allOff: true}.");m(B)}function o(a,b,c,d){function e(){"on"===b?(a.addClass(w),a.removeClass(x)):(a.removeClass(w),a.addClass(x)),u.outsideTurnsOff&&q(a,b,u.outsideTurnsOff)}p(e,c),d({action:b,$el:a})}function p(a,b){b?window.setTimeout(a,b):a()}function q(a,b,c){function d(){var b="click touchend",d=c===!0?a:$(c);d.on(b,function(a){a.stopPropagation()}),$(document).one(b,function(){d.is($(b.target))||(m(a),e())})}function e(){$(document).off()}"on"===b?d():e()}function r(a){var b,c=f().first().data("uft-group"),d=Math.min.apply(Math,z),e=Math.max.apply(Math,z);"next"===a?b=e>=c+1?c+1:d:"prev"===a&&(b=c-1>=d?c-1:e),j(g(b))}function s(){r("next")}function t(){r("prev")}var u=$.extend({},this.defaults,a),v=$(u.root),w=u.onClass,x=u.offClass,y=v.find(u.triggerSelector),z=[],A=0,B=u.scattered?y.add(u.contentSelector):v.find(u.groupSelector);return b.call(this),{trigger:e,disable:d,enable:c,turnAllOn:l,turnAllOff:n,next:s,prev:t}}UnfinishedToggler.prototype.utils={simpleDebounce:function(a){var b,c,d,e,f,g=200;return function(){d=this,c=arguments,e=new Date;var h=function(){var i=new Date-e;g>i?b=setTimeout(h,g-i):(b=null,f=a.apply(d,c))};return b||(b=setTimeout(h,g)),f}}},UnfinishedToggler.prototype.defaults={root:"body",onClass:"uft-on",offClass:"uft-off",groupSelector:".uft-group",triggerSelector:".uft-trigger",contentSelector:".uft-content",nextSelector:!1,prevSelector:!1,scattered:!1,onlyOneOn:!0,allOff:!0,initial:!1,event:"click",onCallback:function(){},offCallback:function(){},onDelay:0,offDelay:0,outsideTurnsOff:!1};